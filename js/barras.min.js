/*! Radiografia_de_las_carceles 2014-11-02 */
var es_ES={decimal:",",thousands:".",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],shortDays:["Dom","Lun","Mar","Mie","Jue","Vie","Sab"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},ES=d3.locale(es_ES),formatNumber={Presos:ES.numberFormat(","),Presupuesto:ES.numberFormat("$,.0f"),Costo_Preso_Mes:ES.numberFormat("$,.0f"),Reincidencia:ES.numberFormat(".1%"),No_Trabaja:ES.numberFormat(".1%"),"No_Tuvo_Capacitación_Laboral":ES.numberFormat("%"),No_Estudia:ES.numberFormat(".1%")},formatData=function(a,b){var c=parseFloat(a),d=a.match(/%/)?c/100:c,e=d3.formatPrefix(d);switch(d=d||"-",e.symbol){case"M":d=b(e.scale(parseFloat(d)))+" M";break;case"G":d=b(e.scale(1e3*parseFloat(d)))+" M";break;case"T":d=b(e.scale(parseFloat(d)))+" B"}return isNaN(d)?d:b(d)},BarsGenerator=function(){function a(a,b){return d3.max(b,function(b){return parseFloat(b[a])})}function b(a,b,c){return c&&c(a),a.append("div").attr("id","bars-"+b).attr("class","bars")}function c(a,c,e){var f=b(a,c,function(a){a.select("div[id|='bars']").remove()});return d(f,c,e)}function d(a,b,c){var d=a.selectAll("div.bar").data(c).enter().append("div").attr("class",function(a){return"bar "+a.Jurisdiccion.toLowerCase()}).attr("style","width: 0;");return e(d,b,c),d}function e(b,c,d){var e=a(c,d);return b.transition().duration(850).attr("style",function(a){var b=a[c].match(/%/)?a[c]:parseFloat(a[c])/e*100+"%";return"width:"+b+";"}),b}return{update:e,initialize:c}}(window);queue().defer(d3.tsv,"data/estadisticas_jurisdiccionales.tsv?timestamp=201411010935").awaitAll(function(a,b){b=b[0].sort(function(a,b){return d3.ascending(a.Jurisdiccion,b.Jurisdiccion)||d3.ascending(a.Provincia,b.Provincia)});var c=d3.select("#mySelect").node().value,d=BarsGenerator.initialize(d3.select("#barrasPuras"),c,b),e=d.data().map(function(a){return a.Provincia});d3.select("#barrasProvincias").selectAll("div").data(e).enter().append("div").text(function(a){return a});var f=d3.select("#barrasNumeros").selectAll("div").data(b).enter().append("div").attr("data-info",function(a){return parseFloat(a[c])}).text(function(a){var b=formatData(a[c],formatNumber[c]);return"-"==b?"":b});d3.select("#mySelect").on("change",function(){var a=d3.select("#mySelect").node().value;BarsGenerator.update(d,a,b),f.attr("data-info",function(b){return parseFloat(b[a])}).text(function(b){var c=formatData(b[a],formatNumber[a]);return"-"==c?"":c})})});